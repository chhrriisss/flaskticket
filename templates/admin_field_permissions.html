{% extends "base.html" %}

{% block title %}Field Permissions - {{ field_name }}{% endblock %}

{% block content %}
<div class="card">
    <div class="card-header">
        <h2>Field Permissions: {{ field_config.label }} ({{ field_name }})</h2>
    </div>
    <div class="card-body">
        <div class="alert alert-info">
            <strong>Configure who can read, edit, and delete this field based on their role.</strong><br>
        </div>
        
        <form method="POST">
            <table class="table">
                <thead>
                    <tr>
                        <th>Role</th>
                        <th style="text-align: center;">Read</th>
                        <th style="text-align: center;">Write (Edit)</th>
                        <th style="text-align: center;">Delete</th>
                    </tr>
                </thead>
                <tbody>
                    {% for role in roles %}
                    <tr>
                        <td><strong>{{ role|title }}</strong></td>
                        <td style="text-align: center;">
                            <input type="checkbox" name="read_{{ role }}" value="1"
                                   {% if current_permissions.get(role, {}).get('read', False) %}checked{% endif %}
                                   {% if role == 'admin' %}checked disabled{% endif %}>
                        </td>
                        <td style="text-align: center;">
                            <input type="checkbox" name="write_{{ role }}" value="1"
                                   {% if current_permissions.get(role, {}).get('write', False) %}checked{% endif %}
                                   {% if role == 'admin' %}checked disabled{% endif %}>
                        </td>
                        <td style="text-align: center;">
                            <input type="checkbox" name="delete_{{ role }}" value="1"
                                   {% if current_permissions.get(role, {}).get('delete', False) %}checked{% endif %}
                                   {% if role == 'admin' %}checked disabled{% endif %}>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            <div class="form-group text-right mt-3">
                <a href="{{ url_for('admin_config') }}" class="btn btn-secondary">Cancel</a>
                <button type="submit" class="btn btn-primary">Save Permissions</button>
            </div>
        </form>
    </div>
</div>

<div class="card">
    <div class="card-header">
        <h3>Current Field Configuration</h3>
    </div>
    <div class="card-body">
        <div class="form-row">
            <div class="form-col">
                <strong>Field Name:</strong> <code>{{ field_name }}</code><br>
                <strong>Label:</strong> {{ field_config.label }}<br>
                <strong>Type:</strong> <span class="status-ongoing">{{ field_config.type|title }}</span>
            </div>
            <div class="form-col">
                <strong>Options:</strong> 
                {% if field_config.get('options') %}
                {{ field_config.options|join(', ') }}
                {% else %}
                <span style="color: #999;">None</span>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}